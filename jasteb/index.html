
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Order Jasteb Otomatis</title>
    <meta name="description" content="JASTEB VIP LUKY NESIA ">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* GABUNGAN CSS DARI DUA FILE SEBELUMNYA */
        :root {
            --primary-color: #0b0f1a;
            --secondary-color: #131a2b;
            --accent-color: #3a7bd5;
            --highlight-color: #1c90f3;
            --gold-color: #e6b800;
            --text-color: #e1e8f7;
            --border-color: rgba(255, 255, 255, 0.12);
            --glass-bg: rgba(20, 28, 48, 0.6);
            --shadow-color: rgba(0, 80, 200, 0.5);
            --success-color: #28a745;
        }

        body {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            font-family: 'Montserrat', sans-serif;
            color: var(--text-color);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 15px;
            border: 1px solid var(--border-color);
            box-shadow: 0 15px 35px var(--shadow-color);
            overflow: hidden;
            transition: all 0.3s ease;
            position: relative;
            z-index: 1;
            margin-bottom: 20px;
        }

        .glass-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-color), var(--highlight-color));
            z-index: 2;
        }

        .glass-card.success-card::before {
            background: linear-gradient(90deg, var(--gold-color), #ffcc00);
        }

        .header-title {
            font-family: 'Playfair Display', serif;
            font-weight: 700;
            color: var(--text-color);
            text-shadow: 0 2px 12px rgba(28, 144, 243, 0.8);
            position: relative;
            display: inline-block;
        }

        .btn-premium {
            background: linear-gradient(135deg, var(--accent-color), var(--highlight-color));
            border: none;
            color: var(--primary-color);
            font-weight: 600;
            letter-spacing: 0.5px;
            border-radius: 8px;
            padding: 12px 28px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(28, 144, 243, 0.6);
            text-transform: uppercase;
            font-size: 0.9rem;
            width: 100%;
        }

        .btn-premium:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(28, 144, 243, 0.9);
            color: var(--primary-color);
        }

        /* Tombol Konfirmasi Bayar */
        .btn-confirm-pay {
            background: linear-gradient(135deg, var(--success-color), #1e7e34);
            border: none;
            color: white;
            font-weight: 600;
            border-radius: 8px;
            padding: 12px 28px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.4);
            text-transform: uppercase;
            font-size: 0.9rem;
            width: 100%;
            margin-bottom: 10px;
        }

        .btn-confirm-pay:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(40, 167, 69, 0.6);
            color: white;
        }

        .form-control {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-color);
            color: var(--text-color);
            border-radius: 8px;
            padding: 12px 15px;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            background: rgba(28, 144, 243, 0.1);
            border-color: var(--accent-color);
            box-shadow: 0 0 8px var(--accent-color);
            color: var(--text-color);
        }

        .amount-option {
            cursor: pointer;
            padding: 12px;
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            margin-bottom: 8px;
            text-align: center;
            transition: all 0.3s ease;
            color: var(--text-color);
        }

        .amount-option.active {
            background: rgba(28, 144, 243, 0.12);
            border-color: var(--accent-color);
            color: var(--accent-color);
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(28, 144, 243, 0.3);
        }

        .qr-image {
            max-width: 100%;
            height: auto;
            margin: 0 auto;
            display: block;
            border: 15px solid rgba(255, 255, 255, 0.12);
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(28, 144, 243, 0.5);
            background: var(--primary-color);
            padding: 1px;
        }

        /* Success Page Styles */
        .success-icon {
            font-size: 80px;
            color: var(--success-color);
            margin-bottom: 20px;
            text-shadow: 0 0 20px rgba(40, 167, 69, 0.5);
        }

        .detail-item {
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .detail-label {
            font-weight: 600;
            color: var(--gold-color);
        }

        .btn-whatsapp {
            background: linear-gradient(135deg, #25D366, #128C7E);
            border: none;
            color: white;
            font-weight: 600;
            letter-spacing: 0.5px;
            border-radius: 8px;
            padding: 12px 28px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(37, 211, 102, 0.3);
            text-transform: uppercase;
            font-size: 0.9rem;
            width: 100%;
            text-decoration: none;
            display: block;
            text-align: center;
            margin-bottom: 10px;
        }
        
        .btn-whatsapp:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(37, 211, 102, 0.4);
            color: white;
        }

        /* Utilities */
        .hidden { display: none !important; }
        .spinner-border { width: 3rem; height: 3rem; border-width: 0.25em; color: var(--accent-color); }
        .particle { position: absolute; background: rgba(28, 144, 243, 0.6); border-radius: 50%; pointer-events: none; z-index: 0; }
        .particle.gold { background: rgba(230, 184, 0, 0.6); }

        @keyframes glow {
            0% { box-shadow: 0 0 8px rgba(28, 144, 243, 0.5); }
            50% { box-shadow: 0 0 24px rgba(28, 144, 243, 0.9); }
            100% { box-shadow: 0 0 8px rgba(28, 144, 243, 0.5); }
        }
        .glowing { animation: glow 2s infinite; }

    </style>
</head>
<body>
    <!-- Particles Container -->
    <div id="particles"></div>
    
    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-lg-7 col-md-9">
                
                <!-- === BAGIAN 1: FORM ORDER === -->
                <div id="order-section" class="glass-card p-4 p-md-5">
                    <div class="text-center mb-5">
                        <h2 class="header-title mb-3">
                            <i class="fas fa-crown me-2" style="color: var(--gold-color);"></i> Order Jasteb Otomatis 
                        </h2>
                    </div>
                    
                    <form id="payment-form">
                        <div class="form-group mb-4">
                            <label class="form-label mb-2">Kategori *</label>
                            <select class="form-select" id="kategori" name="kategori" required>
                                <option value="JASTEB VIP">JASTEB VIP</option>
                            </select>
                        </div>

                        <div class="form-group mb-4">
                            <label class="form-label mb-2">Target Email *</label>
                            <input type="email" name="target" id="target-email" class="form-control" placeholder="emailmu@gmail.com" required>
                        </div>

                        <div class="form-group mb-4">
                            <label class="form-label mb-2">Jumlah Result *</label>
                            <div class="row g-2">
                                <div class="col-4">
                                    <div class="amount-option active" data-amount="5000" data-quantity="90">Rp5.000<div>90+ Result</div></div>
                                </div>
                                <div class="col-4">
                                    <div class="amount-option" data-amount="10000" data-quantity="170">Rp10.000<div>170+ Result</div></div>
                                </div>
                                <div class="col-4">
                                    <div class="amount-option" data-amount="15000" data-quantity="260">Rp15.000<div>260+ Result</div></div>
                                </div>
                                <div class="col-4">
                                    <div class="amount-option" data-amount="20000" data-quantity="300">Rp20.000<div>300+ Result</div></div>
                                </div>
                                <div class="col-4">
                                    <div class="amount-option" data-amount="25000" data-quantity="350">Rp25.000<div>350+ Result</div></div>
                                </div>
                                <div class="col-4">
                                    <div class="amount-option" data-amount="30000" data-quantity="480">Rp30.000<div>480+ Result</div></div>
                                </div>
                            </div>
                            <input type="hidden" id="selected-quantity" name="jumlah" value="100" required>
                        </div>

                        <div class="form-group mb-4">
                            <label class="form-label mb-2">Total Harga</label>
                            <div class="input-group">
                                <span class="input-group-text">Rp</span>
                                <input type="text" class="form-control" id="total-price" value="5,000" readonly>
                            </div>
                        </div>

                        <div class="d-grid mt-4">
                            <button type="button" id="pay-button" class="btn btn-premium btn-lg glowing">
                                <i class="fas fa-paper-plane me-2"></i> ORDER
                            </button>
                        </div>
                    </form>

                    <!-- Loading -->
                    <div id="loading" class="text-center my-4 py-4 hidden">
                        <div class="spinner-border mb-3" role="status"></div>
                        <p class="text-muted">Memproses Pesanan...</p>
                    </div>

                    <!-- Payment QR Section -->
                    <div id="payment-result" class="mt-4 hidden">
                        <div class="text-center">
                            <h4 class="mb-4">Scan QR Code</h4>
                            <p class="text-muted mb-4">Transfer sesuai nominal di bawah ini (Termasuk 3 digit kode unik).</p>
                            
                            <!-- GANTI SRC DENGAN LINK FOTO QRIS KAMU -->
                            <img id="qr-image" class="qr-image mb-4" src="https://cdn.jsdelivr.net/gh/styleesheet/img@main/IMG_20260215_005945.jpg" alt="QR Code">
                            
                            <div class="payment-details" style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                                <p class="mb-2">Total Bayar: <strong id="payment-amount" class="text-white" style="font-size: 1.2em;">Rp 0</strong></p>
                                <p class="mb-0 text-muted small">ID Transaksi: <span id="transaction-id-display"></span></p>
                            </div>
                            
                            <!-- TOMBOL KONFIRMASI MANUAL (Karena tidak ada API) -->
                            <button id="confirm-payment-btn" class="btn btn-confirm-pay btn-lg">
                                <i class="fas fa-check-circle me-2"></i> SAYA SUDAH BAYAR
                            </button>

                            <button id="back-button" class="btn btn-outline-light mt-2 w-100">
                                <i class="fas fa-arrow-left me-2"></i> Batal
                            </button>
                        </div>
                    </div>
                </div>

                <!-- === BAGIAN 2: HALAMAN SUKSES === -->
                <div id="success-section" class="glass-card success-card p-4 p-md-5 hidden">
                    <div class="text-center mb-4">
                        <h2 class="header-title mb-3" style="color:white;">
                            <i class="fas fa-crown me-2" style="color: var(--gold-color);"></i> PEMBAYARAN BERHASIL
                        </h2>
                        <div class="success-icon-container">
                            <i class="fas fa-check-circle success-icon"></i>
                        </div>
                    </div>
                    
                    <div id="transaction-details" class="mb-5">
                        <h4 class="text-center mb-4" style="color: var(--gold-color);">Detail Pesanan</h4>
                        
                        <div class="detail-item">
                            <div class="row">
                                <div class="col-md-5 detail-label">Kategori:</div>
                                <div class="col-md-7" id="success-category"></div>
                            </div>
                        </div>
                        
                        <div class="detail-item">
                            <div class="row">
                                <div class="col-md-5 detail-label">Jumlah Result:</div>
                                <div class="col-md-7" id="success-quantity"></div>
                            </div>
                        </div>
                        
                        <div class="detail-item">
                            <div class="row">
                                <div class="col-md-5 detail-label">Email Target:</div>
                                <div class="col-md-7" id="success-email"></div>
                            </div>
                        </div>
                        
                        <div class="detail-item">
                            <div class="row">
                                <div class="col-md-5 detail-label">Total Pembayaran:</div>
                                <div class="col-md-7" id="success-amount"></div>
                            </div>
                        </div>
                        
                        <div class="detail-item">
                            <div class="row">
                                <div class="col-md-5 detail-label">ID Transaksi:</div>
                                <div class="col-md-7" id="success-trx"></div>
                            </div>
                        </div>
                        
                        <div class="detail-item" style="border-bottom: none;">
                            <div class="row">
                                <div class="col-md-5 detail-label">Status:</div>
                                <div class="col-md-7" style="color: var(--success-color); font-weight: bold;">LUNAS (Sedang Proses)</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="alert alert-premium mb-4" style="background: rgba(230, 184, 0, 0.1); border: 1px solid var(--gold-color); color: white; border-radius: 10px;">
                        <h5><i class="fas fa-info-circle me-2"></i>JASTEB SEDANG KAMI PROSES</h5>
                        <p class="mb-0 small">Estimasi masuk 1-5 menit. Jika lewat waktu itu, hubungi admin.</p>
                    </div>
                    
                    <div class="d-grid mb-4">
                        <a id="whatsapp-button" class="btn btn-whatsapp" target="_blank">
                            <i class="fab fa-whatsapp me-2"></i> Hubungi Admin
                        </a>
                    </div>
                    
                    <div class="text-center">
                        <button id="back-to-home" class="btn btn-outline-light w-100">
                            <i class="fas fa-redo me-2"></i> Order Lagi
                        </button>
                    </div>
                </div>
                
                <div class="text-center mt-4">
                    <p class="text-muted small">Â© Since 2023 . All rights reserved.</p>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- PARTIKEL ---
            const particleContainer = document.getElementById('particles');
            for(let i=0; i<20; i++) {
                const p = document.createElement('div');
                p.className = 'particle';
                p.style.left = Math.random()*100 + 'vw';
                p.style.top = Math.random()*100 + 'vh';
                p.style.width = p.style.height = (Math.random()*5+3) + 'px';
                p.style.opacity = Math.random()*0.5;
                particleContainer.appendChild(p);
            }

            // --- VARIABEL UTAMA ---
            const amountOptions = document.querySelectorAll('.amount-option');
            const payButton = document.getElementById('pay-button');
            const orderSection = document.getElementById('order-section');
            const successSection = document.getElementById('success-section');
            
            const paymentForm = document.getElementById('payment-form');
            const paymentResult = document.getElementById('payment-result');
            const loading = document.getElementById('loading');
            const backButton = document.getElementById('back-button');
            const confirmPaymentBtn = document.getElementById('confirm-payment-btn'); // Tombol "Saya Sudah Bayar"

            const totalPriceInput = document.getElementById('total-price');
            const selectedQuantityInput = document.getElementById('selected-quantity');
            const qrImage = document.getElementById('qr-image');
            const paymentAmountDisplay = document.getElementById('payment-amount');
            const transactionIdDisplay = document.getElementById('transaction-id-display');

            // Elemen Sukses
            const successCategory = document.getElementById('success-category');
            const successQuantity = document.getElementById('success-quantity');
            const successEmail = document.getElementById('success-email');
            const successAmount = document.getElementById('success-amount');
            const successTrx = document.getElementById('success-trx');
            const whatsappBtn = document.getElementById('whatsapp-button');
            const backToHomeBtn = document.getElementById('back-to-home');

            let selectedAmount = 5000;
            let currentTransactionData = null;

            // 1. PILIH PAKET
            amountOptions.forEach(option => {
                option.addEventListener('click', function() {
                    amountOptions.forEach(opt => opt.classList.remove('active'));
                    this.classList.add('active');
                    selectedAmount = parseInt(this.dataset.amount);
                    const qty = this.dataset.quantity;
                    selectedQuantityInput.value = qty;
                    totalPriceInput.value = selectedAmount.toLocaleString('id-ID');
                });
            });

            // 2. TOMBOL ORDER (Menampilkan QR)
            payButton.addEventListener('click', function() {
                const email = document.getElementById('target-email').value;
                if(!email.includes('@')) { alert('Email tidak valid!'); return; }

                // Hitung Kode Unik
                const uniqueCode = Math.floor(Math.random() * (999 - 100 + 1)) + 100;
                const finalAmount = selectedAmount + uniqueCode;
                const trxId = 'TRX-' + Math.floor(Math.random() * 1000000);

                // Simpan Data
                currentTransactionData = {
                    kategori: document.getElementById('kategori').value,
                    target: email,
                    jumlah: selectedQuantityInput.value,
                    total: finalAmount, // Total dengan kode unik
                    originalTotal: selectedAmount,
                    trxId: trxId,
                    timestamp: new Date().toISOString()
                };

                // UI Transisi
                paymentForm.style.display = 'none';
                loading.classList.remove('hidden');

                setTimeout(() => {
                    loading.classList.add('hidden');
                    paymentResult.classList.remove('hidden');
                    
                    // Tampilkan Data
                    qrImage.style.display = 'block';
                    paymentAmountDisplay.textContent = 'Rp ' + finalAmount.toLocaleString('id-ID');
                    transactionIdDisplay.textContent = trxId;

                }, 1500);
            });

            // 3. TOMBOL "SAYA SUDAH BAYAR" -> OTOMATIS KE HALAMAN SUKSES
            confirmPaymentBtn.addEventListener('click', function() {
                if(!currentTransactionData) return;

                // Simpan ke Session agar bisa direfresh jika perlu (opsional)
                sessionStorage.setItem('transactionData', JSON.stringify(currentTransactionData));

                // Panggil API Internal (req/ZendsCode/add.php)
                // Ini menjalankan logika PHP di belakang layar
                sendOrderData(currentTransactionData.target, currentTransactionData.jumlah);

                // Tampilkan Halaman Sukses
                showSuccessPage();
            });

            // 4. FUNGSI TAMPILKAN HALAMAN SUKSES
            function showSuccessPage() {
                orderSection.classList.add('hidden');
                successSection.classList.remove('hidden');

                if(!currentTransactionData) return;

                // Isi Detail
                successCategory.textContent = currentTransactionData.kategori;
                successQuantity.textContent = currentTransactionData.jumlah + ' Results';
                successEmail.textContent = currentTransactionData.target;
                successAmount.textContent = 'Rp ' + currentTransactionData.total.toLocaleString('id-ID');
                successTrx.textContent = currentTransactionData.trxId;

                // Link WA
                const waMsg = `Halo Admin, saya sudah transfer.%0AID: ${currentTransactionData.trxId}%0AEmail: ${currentTransactionData.target}%0ANominal: Rp ${currentTransactionData.total}`;
                whatsappBtn.href = `https://wa.me/6289509551861?text=${waMsg}`;
            }

            // 5. API SENDER (Fetch)
            function sendOrderData(email, jumlah) {
                const apiUrl = 'req/ZendsCode/add.php';
                const formData = new FormData();
                formData.append('email', email);
                formData.append('jumlahResult', jumlah);
                
                fetch(apiUrl, {
                    method: 'POST',
                    body: formData
                })
                .then(res => res.json())
                .then(data => console.log('Order sent:', data))
                .catch(err => console.error('API Error:', err));
            }

            // 6. TOMBOL BATAL / KEMBALI
            backButton.addEventListener('click', function() {
                paymentResult.classList.add('hidden');
                paymentForm.style.display = 'block';
            });

            backToHomeBtn.addEventListener('click', function() {
                location.reload(); // Refresh halaman untuk reset
            });

            // Cek apakah ada data session saat load (jika user refresh di halaman sukses)
            const storedData = sessionStorage.getItem('transactionData');
            if(storedData) {
                currentTransactionData = JSON.parse(storedData);
                showSuccessPage();
            }
        });
    </script>
</body>
</html>
